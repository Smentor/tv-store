(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8545,e=>{"use strict";var a=e.i(88851),s=e.i(27225),t=e.i(86733),r=e.i(68459),i=e.i(70021);function n({user:e,profile:n}){let l=(0,i.useRouter)(),c=(0,r.createClient)(),o=async()=>{await c.auth.signOut(),l.push("/auth/login")},d=n?.first_name&&n?.last_name?`${n.first_name} ${n.last_name}`:n?.first_name?n.first_name:e?.email?e.email.split("@")[0]:"Usuario";return(0,a.jsx)("header",{className:"border-b border-border bg-card",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold text-lg",children:"üì∫"})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-foreground",children:"MaxPlayer IPTV"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:d}),(0,a.jsx)(s.Button,{onClick:o,variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",children:(0,a.jsx)(t.LogOut,{className:"w-4 h-4"})})]})]})})}e.s(["HeaderNav",()=>n])},14800,e=>{"use strict";var a=e.i(88851),s=e.i(17641),t=e.i(11333);let r=(0,t.default)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var i=e.i(43907),n=e.i(21162);let l=(0,t.default)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),c=(0,t.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function o({children:e,currentView:s,setCurrentView:t}){let o=[{id:"home",label:"Inicio",icon:r},{id:"plans",label:"Planes",icon:i.Tv},{id:"billing",label:"Facturaci√≥n",icon:n.FileText},{id:"credentials",label:"Credenciales",icon:l},{id:"settings",label:"Configuraci√≥n",icon:c}];return(0,a.jsxs)("div",{className:"flex gap-6 max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsx)("aside",{className:"w-64 flex flex-col gap-2 sticky top-8 h-fit",children:(0,a.jsx)("nav",{className:"space-y-2",children:o.map(e=>{let r=e.icon,i=s===e.id;return(0,a.jsxs)("button",{onClick:()=>t(e.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors ${i?"bg-primary text-primary-foreground":"text-foreground hover:bg-muted"}`,children:[(0,a.jsx)(r,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:e.label})]},e.id)})})}),(0,a.jsx)("main",{className:"flex-1",children:e})]})}var d=e.i(60814),m=e.i(28303),m=m,u=e.i(97739),u=u,x=e.i(51305);let h=(0,t.default)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var g=e.i(90100),p=e.i(92201),f=e.i(93680);let j=(0,t.default)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),b=(0,t.default)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var N=e.i(68459);function v(){let[e,a]=(0,s.useState)(null),[t,r]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=(0,N.createClient)();(async()=>{console.log("[useAuth] Fetching user...");try{let{data:{user:s}}=await e.auth.getUser();console.log("[useAuth] User fetched:",s?.email||"No user"),a(s)}finally{r(!1)}})();let{data:{subscription:s}}=e.auth.onAuthStateChange((e,s)=>{a(s?.user??null)});return()=>s?.unsubscribe()},[]),{user:e,loading:t}}function y(){let[e,a]=(0,s.useState)(null),[t,r]=(0,s.useState)(!0),[i,n]=(0,s.useState)(null),{user:l}=v(),c=(0,s.useCallback)(async()=>{if(console.log("[useSubscription] fetchSubscription called, user:",l?.email||"No user"),!l){console.log("[useSubscription] No user, skipping fetch"),a(null),r(!1);return}try{console.log("[useSubscription] Fetching subscription for user:",l.id),r(!0);let e=(0,N.createClient)(),{data:s,error:t}=await e.from("subscriptions").select(`
          *,
          plan:plans!subscriptions_plan_id_fkey (
            id,
            name,
            max_screens,
            price
          )
        `).eq("user_id",l.id).order("created_at",{ascending:!1}).limit(1).single();if(t&&"PGRST116"!==t.code)throw t;console.log("[useSubscription] Subscription fetched:",s?.plan_name||"No subscription"),a(s||null),n(null)}catch(e){console.error("[useSubscription] Error:",e),n(e instanceof Error?e.message:"Error fetching subscription")}finally{r(!1)}},[l]);return(0,s.useEffect)(()=>{c()},[c]),{subscription:e,loading:t,error:i,refetch:c}}var w=e.i(39850),C=e.i(96299);function k(){let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(!0),n=(0,s.useCallback)(async()=>{let e=(0,N.createBrowserClient)(),{data:{user:a}}=await e.auth.getUser();if(!a)return;let{data:s,error:r}=await e.from("notifications").select("*").eq("user_id",a.id).eq("read",!1).order("created_at",{ascending:!1});!r&&s&&t(s),i(!1)},[]);(0,s.useEffect)(()=>{n();let e=(0,N.createBrowserClient)(),a=e.channel("notifications-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:"read=eq.false"},e=>{n()}).subscribe();return()=>{e.removeChannel(a)}},[n]);let l=async e=>{t(a=>a.filter(a=>a.id!==e));let a=(0,N.createBrowserClient)();await a.from("notifications").update({read:!0}).eq("id",e)};return r||0===e.length?null:(0,a.jsx)("div",{className:"space-y-3 mb-6",children:e.map(e=>(0,a.jsxs)("div",{className:`relative flex items-start gap-4 p-4 rounded-lg border ${(e=>{switch(e){case"success":return"border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-900";case"warning":return"border-orange-200 bg-orange-50 dark:bg-orange-900/20 dark:border-orange-900";case"error":return"border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-900";default:return"border-blue-200 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-900"}})(e.type)} shadow-sm transition-all animate-in fade-in slide-in-from-top-2`,children:[(0,a.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(e=>{switch(e){case"success":return(0,a.jsx)(p.CheckCircle,{className:"h-5 w-5 text-green-600"});case"warning":return(0,a.jsx)(g.AlertTriangle,{className:"h-5 w-5 text-orange-600"});case"error":return(0,a.jsx)(C.AlertCircle,{className:"h-5 w-5 text-red-600"});default:return(0,a.jsx)(f.Info,{className:"h-5 w-5 text-blue-600"})}})(e.type)}),(0,a.jsxs)("div",{className:"flex-1 mr-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-sm mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:e.message}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground/60 mt-2",children:[new Date(e.created_at).toLocaleDateString()," ‚Ä¢ ",new Date(e.created_at).toLocaleTimeString()]})]}),(0,a.jsx)("button",{onClick:()=>l(e.id),className:"absolute top-3 right-3 p-1 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition-colors","aria-label":"Cerrar notificaci√≥n",children:(0,a.jsx)(w.X,{className:"h-4 w-4 text-muted-foreground"})})]},e.id))})}function D({setCurrentView:e}){let{subscription:t,loading:r}=y(),[n,c]=(0,s.useState)(!1),[o,v]=(0,s.useState)([]);(0,s.useEffect)(()=>{r||n||c(!0)},[r,n]),(0,s.useEffect)(()=>{w()},[]);let w=async()=>{let e=(0,N.createClient)(),a=new Date().toISOString(),{data:s,error:t}=await e.from("promotions").select("*").eq("active",!0).or(`start_date.is.null,start_date.lte.${a}`).or(`end_date.is.null,end_date.gte.${a}`);!t&&s&&v(s)},C=t?Math.ceil((new Date(t.next_billing_date).getTime()-Date.now())/864e5):0,D=t?.plan?.max_screens||1,S=2/D*100,_=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),E=t&&"active"===t.status?C<=2?{variant:"warning",icon:g.AlertTriangle,title:"Renovaci√≥n Pr√≥xima",message:`Tu suscripci\xf3n caduca en ${C} d\xeda${1===C?"":"s"}. Aseg\xfarate de que tu m\xe9todo de pago est\xe9 actualizado.`,bgColor:"bg-orange-50 dark:bg-orange-950/30",borderColor:"border-orange-200 dark:border-orange-900",iconColor:"text-orange-600 dark:text-orange-400"}:C<=7?{variant:"info",icon:f.Info,title:"Informaci√≥n",message:`Tu suscripci\xf3n se renovar\xe1 en ${C} d\xedas. Tu pr\xf3xima facturaci\xf3n es el ${_(t.next_billing_date)}.`,bgColor:"bg-blue-50 dark:bg-blue-950/30",borderColor:"border-blue-200 dark:border-blue-900",iconColor:"text-blue-600 dark:text-blue-400"}:{variant:"success",icon:p.CheckCircle,title:"Todo en Orden",message:"Tu suscripci√≥n est√° activa y funcionando correctamente. Para cualquier inconveniente, contacta a nuestro soporte.",bgColor:"bg-green-50 dark:bg-green-950/30",borderColor:"border-green-200 dark:border-green-900",iconColor:"text-green-600 dark:text-green-400"}:{variant:"destructive",icon:g.AlertTriangle,title:"Atenci√≥n Requerida",message:"Tu suscripci√≥n no est√° activa. Por favor contacta a soporte o renueva tu plan.",bgColor:"bg-red-50 dark:bg-red-950/30",borderColor:"border-red-200 dark:border-red-900",iconColor:"text-red-600 dark:text-red-400"},T=E.icon;return r&&!n?(0,a.jsx)("div",{className:"text-center py-8",children:"Cargando informaci√≥n..."}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-foreground mb-2",children:"Bienvenido de vuelta"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Aqu√≠ est√° el resumen de tu cuenta"})]}),(0,a.jsx)(k,{}),o.length>0&&(0,a.jsx)(d.Card,{className:"p-4 border-2 border-orange-500 bg-gradient-to-r from-orange-50 to-amber-50 dark:from-orange-950/30 dark:to-amber-950/30 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(b,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h3",{className:"font-bold text-orange-900 dark:text-orange-100 mb-1 text-lg",children:["üéâ ¬°Promoci√≥n Activa! ",o[0].name]}),(0,a.jsx)("p",{className:"text-sm text-orange-700 dark:text-orange-200 mb-3",children:o[0].description}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"inline-flex items-center gap-2 bg-orange-600 text-white px-4 py-2 rounded-full text-sm font-semibold shadow-md",children:o[0].discount_percentage?(0,a.jsxs)(a.Fragment,{children:[o[0].discount_percentage,"% de descuento"]}):(0,a.jsxs)(a.Fragment,{children:["S/ ",o[0].discount_amount," de descuento"]})}),(0,a.jsx)("button",{onClick:()=>e("plans"),className:"text-sm text-orange-700 dark:text-orange-200 hover:text-orange-900 dark:hover:text-orange-100 font-semibold underline",children:"Ver planes ‚Üí"})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(d.Card,{className:"p-6 border border-border bg-card hover:shadow-lg transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Plan Actual"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-foreground",children:t?.plan_name||"Sin plan"}),(0,a.jsx)("p",{className:"text-xs text-accent mt-2",children:t?.status==="active"?"Activo":"Inactivo"})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-accent/10 rounded-lg flex items-center justify-center",children:(0,a.jsx)(i.Tv,{className:"w-6 h-6 text-accent"})})]})}),(0,a.jsx)(d.Card,{className:"p-6 border border-border bg-card hover:shadow-lg transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Pr√≥xima Facturaci√≥n"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-foreground",children:t?_(t.next_billing_date):"N/A"}),(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-2 flex items-center gap-1",children:[(0,a.jsx)(u.default,{className:"w-3 h-3"})," ",t?.status==="active"?"Activo":"Inactivo"]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.default,{className:"w-6 h-6 text-green-600"})})]})}),(0,a.jsx)(d.Card,{className:"p-6 border border-border bg-card hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>{e("settings"),setTimeout(()=>{document.getElementById("devices-section")?.scrollIntoView({behavior:"smooth",block:"start"})},100)},children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Dispositivos Conectados"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-foreground",children:[2," de ",D]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Dispositivos activos"})]}),(0,a.jsxs)("div",{className:"relative w-16 h-16 flex-shrink-0",children:[(0,a.jsxs)("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36",children:[(0,a.jsx)("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-muted",strokeWidth:"3"}),(0,a.jsx)("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-accent",strokeWidth:"3",strokeDasharray:`${S} 100`,strokeLinecap:"round"})]}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)(j,{className:"w-6 h-6 text-accent"})})]})]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Acciones R√°pidas"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(d.Card,{className:"p-4 border border-border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>e("plans"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-accent/10 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(i.Tv,{className:"w-5 h-5 text-accent"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Cambiar de Plan"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Actualiza a un plan superior"})]})]}),(0,a.jsx)(m.default,{className:"w-5 h-5 text-muted-foreground"})]})}),(0,a.jsx)(d.Card,{className:"p-4 border border-border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>e("billing"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(x.CreditCard,{className:"w-5 h-5 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Ver Facturas"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Historial de pagos"})]})]}),(0,a.jsx)(m.default,{className:"w-5 h-5 text-muted-foreground"})]})}),(0,a.jsx)(d.Card,{className:"p-4 border border-border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>e("credentials"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(l,{className:"w-5 h-5 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Ver Credenciales"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tu usuario y contrase√±a"})]})]}),(0,a.jsx)(m.default,{className:"w-5 h-5 text-muted-foreground"})]})}),(0,a.jsx)(d.Card,{className:"p-4 border border-border bg-card hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>e("support"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(h,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Soporte T√©cnico"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Contacta a nuestro equipo"})]})]}),(0,a.jsx)(m.default,{className:"w-5 h-5 text-muted-foreground"})]})})]})]}),(0,a.jsx)(d.Card,{className:`p-4 border ${E.borderColor} ${E.bgColor}`,children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(T,{className:`w-5 h-5 ${E.iconColor} flex-shrink-0 mt-0.5`}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-foreground mb-1",children:E.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:E.message})]})]})})]})}var S=e.i(27225),_=e.i(99846),E=e.i(32954),u=u;let T=(0,t.default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),P=(0,t.default)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),A=(0,t.default)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),$=(0,t.default)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var L=e.i(88814),F=e.i(11422);let I={basic:T,premium:P,"premium-plus":A};function M({setCurrentView:e}){let[t,r]=(0,s.useState)(null),[i,n]=(0,s.useState)(!1),[l,c]=(0,s.useState)(!1),[o,m]=(0,s.useState)(""),[x,h]=(0,s.useState)(null),[g,p]=(0,s.useState)([]),[f,j]=(0,s.useState)(!1),{subscription:v,refetch:C}=y(),{plans:k,loading:D}=function(){let[e,a]=(0,s.useState)([]),[t,r]=(0,s.useState)(!0),[i,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{!async function(){try{r(!0);let e=(0,N.createClient)(),{data:s,error:t}=await e.from("plans").select("*").order("price",{ascending:!0});if(t)throw t;a(s||[]),n(null)}catch(e){n(e instanceof Error?e.message:"Error fetching plans")}finally{r(!1)}}()},[]),{plans:e,loading:t,error:i}}(),{toast:A}=(0,L.useToast)(),M=v?.plan_id||"basic";(0,s.useEffect)(()=>{B()},[]);let B=async()=>{let e=(0,N.createClient)(),a=new Date().toISOString(),{data:s,error:t}=await e.from("promotions").select("*").eq("active",!0).or(`start_date.is.null,start_date.lte.${a}`).or(`end_date.is.null,end_date.gte.${a}`);!t&&s&&p(s)},q=async()=>{if(!o.trim())return void A({title:"C√≥digo requerido",description:"Por favor ingresa un c√≥digo de cup√≥n",variant:"destructive",duration:3e3});j(!0);let e=(0,N.createClient)(),a=new Date().toISOString(),{data:s,error:t}=await e.from("coupons").select("*").eq("code",o.toUpperCase()).eq("active",!0).single();if(t||!s){A({title:"Cup√≥n inv√°lido",description:"El c√≥digo ingresado no existe o ha expirado",variant:"destructive",duration:3e3}),j(!1);return}if(s.start_date&&new Date(s.start_date)>new Date(a)){A({title:"Cup√≥n no disponible",description:"Este cup√≥n a√∫n no est√° disponible",variant:"destructive",duration:3e3}),j(!1);return}if(s.end_date&&new Date(s.end_date)<new Date(a)){A({title:"Cup√≥n expirado",description:"Este cup√≥n ya no est√° disponible",variant:"destructive",duration:3e3}),j(!1);return}if(s.max_uses&&s.current_uses>=s.max_uses){A({title:"Cup√≥n agotado",description:"Este cup√≥n ya alcanz√≥ su l√≠mite de usos",variant:"destructive",duration:3e3}),j(!1);return}h(s),A({title:"Cup√≥n aplicado",description:`Has obtenido un descuento de ${s.discount_percentage?`${s.discount_percentage}%`:`S/ ${s.discount_amount}`}`,variant:"success",duration:3e3}),j(!1)},R=e=>{let a=e;if(g.length>0){let e=g[0];e.discount_percentage?a-=a*e.discount_percentage/100:e.discount_amount&&(a-=e.discount_amount)}return x&&(x.discount_percentage?a-=a*x.discount_percentage/100:x.discount_amount&&(a-=x.discount_amount)),Math.max(0,a)},z=async()=>{if(t&&v){n(!0);try{let e=(0,N.createClient)(),a=k.find(e=>e.id===t);if(!a)throw Error("Plan no encontrado");let s=R(a.price),{error:i}=await e.from("subscriptions").update({plan_id:a.id,plan_name:a.name,price:s,updated_at:new Date().toISOString()}).eq("user_id",v.user_id);if(i)throw i;x&&await e.from("coupons").update({current_uses:x.current_uses+1}).eq("id",x.id),await e.from("invoices").insert({user_id:v.user_id,amount:s,status:"paid",description:`Cambio a ${a.name}${x?` (Cup\xf3n: ${x.code})`:""}${g.length>0?` (Promoci\xf3n aplicada)`:""}`,invoice_date:new Date().toISOString()}),await C(),A({title:"Plan actualizado exitosamente",description:`Te hemos cambiado al plan ${a.name}${s<a.price?" con descuento aplicado":""}.`,variant:"success",duration:3e3}),c(!1),r(null),h(null),m("")}catch(e){console.error("Error cambiando plan:",e),A({title:"Error al cambiar plan",description:"No se pudo cambiar el plan. Por favor, intenta de nuevo.",variant:"destructive",duration:3e3})}finally{n(!1)}}};return D?(0,a.jsx)("div",{className:"space-y-8",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-foreground mb-2",children:"Planes y Suscripci√≥n"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Cargando planes disponibles..."})]})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-foreground mb-2",children:"Planes y Suscripci√≥n"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Tu plan actual: ",(0,a.jsx)("span",{className:"font-semibold text-primary",children:v?.plan_name||"Cargando..."})]})]}),g.length>0&&(0,a.jsx)(d.Card,{className:"p-4 border-2 border-orange-500 bg-orange-50",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(b,{className:"w-6 h-6 text-orange-600 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-bold text-orange-900 mb-1",children:["¬°Promoci√≥n Activa! ",g[0].name]}),(0,a.jsx)("p",{className:"text-sm text-orange-700 mb-2",children:g[0].description}),(0,a.jsx)("div",{className:"inline-flex items-center gap-2 bg-orange-600 text-white px-3 py-1 rounded-full text-sm font-semibold",children:g[0].discount_percentage?(0,a.jsxs)(a.Fragment,{children:[g[0].discount_percentage,"% de descuento"]}):(0,a.jsxs)(a.Fragment,{children:["S/ ",g[0].discount_amount," de descuento"]})})]})]})}),(0,a.jsxs)(d.Card,{className:"p-6 bg-gradient-to-r from-green-50 to-emerald-50 border-green-200",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-end",children:[(0,a.jsxs)("div",{className:"flex-1 w-full",children:[(0,a.jsxs)(E.Label,{htmlFor:"coupon-code",className:"text-green-900 font-semibold flex items-center gap-2 mb-2",children:[(0,a.jsx)($,{className:"w-4 h-4"}),"¬øTienes un c√≥digo de cup√≥n?"]}),(0,a.jsx)(_.Input,{id:"coupon-code",placeholder:"Ingresa tu c√≥digo",value:o,onChange:e=>m(e.target.value.toUpperCase()),disabled:!!x||f,className:"uppercase"})]}),x?(0,a.jsx)(S.Button,{onClick:()=>{h(null),m(""),A({title:"Cup√≥n removido",description:"El cup√≥n ha sido removido",duration:3e3})},variant:"outline",className:"border-green-600 text-green-600",children:"Remover Cup√≥n"}):(0,a.jsx)(S.Button,{onClick:q,disabled:f||!o.trim(),className:"bg-green-600 hover:bg-green-700 text-white",children:f?"Validando...":"Aplicar Cup√≥n"})]}),x&&(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-sm text-green-700 bg-green-100 px-3 py-2 rounded-lg",children:[(0,a.jsx)(u.default,{className:"w-4 h-4"}),(0,a.jsxs)("span",{className:"font-semibold",children:['Cup√≥n "',x.code,'" aplicado exitosamente']})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map(e=>{let s=I[e.id]||T,t=M===e.id,n=Array.isArray(e.features)?e.features:JSON.parse(e.features||"[]"),l=e.price,o=R(l),m=o<l;return(0,a.jsxs)(d.Card,{className:`relative overflow-hidden transition-all duration-300 flex flex-col ${t?"border-2 border-primary shadow-lg":"border border-border hover:border-primary/50 hover:shadow-md"}`,children:[t&&(0,a.jsxs)("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-primary to-accent text-white px-3 py-1.5 text-center font-semibold text-xs",children:[(0,a.jsx)(u.default,{className:"w-3 h-3 inline mr-1"}),"TU PLAN ACTUAL"]}),(0,a.jsxs)("div",{className:`p-5 flex flex-col flex-1 ${t?"pt-10":""}`,children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,a.jsx)("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center shrink-0 ${t?"bg-primary/10":"bg-muted"}`,children:(0,a.jsx)(s,{className:`w-5 h-5 ${t?"text-primary":"text-muted-foreground"}`})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-foreground mb-0.5 truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-1",children:e.description})]})]}),(0,a.jsx)("div",{className:"mb-4 pb-4 border-b",children:m?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm text-muted-foreground line-through",children:["$",l]}),(0,a.jsxs)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-semibold",children:["-",((l-o)/l*100).toFixed(0),"%"]})]}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,a.jsxs)("span",{className:"text-3xl font-bold text-green-600",children:["$",o.toFixed(2)]}),(0,a.jsx)("span",{className:"text-sm text-green-600",children:"/mes"})]})]}):(0,a.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,a.jsxs)("span",{className:"text-3xl font-bold text-foreground",children:["$",e.price]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"/mes"})]})}),(0,a.jsxs)("ul",{className:"space-y-2 mb-5 flex-1",children:[n.slice(0,6).map((e,s)=>(0,a.jsxs)("li",{className:"flex items-start gap-2 text-sm",children:[(0,a.jsx)(u.default,{className:`w-4 h-4 shrink-0 mt-0.5 ${t?"text-primary":"text-green-600"}`}),(0,a.jsx)("span",{className:"text-foreground/90 leading-tight",children:e})]},s)),n.length>6&&(0,a.jsxs)("li",{className:"text-xs text-muted-foreground italic pl-6",children:["+",n.length-6," caracter√≠sticas m√°s"]})]}),(0,a.jsx)(S.Button,{onClick:()=>{var a;(a=e.id)===M?A({title:"Plan actual",description:"Ya tienes este plan activo",variant:"destructive",duration:3e3}):(r(a),c(!0))},disabled:i||t,className:`w-full ${t?"bg-gradient-to-r from-primary to-accent text-white cursor-default":"bg-primary text-primary-foreground hover:bg-primary/90"}`,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.default,{className:"w-4 h-4 mr-2"}),"Plan Activo"]}):"Seleccionar Plan"})]})]},e.id)})}),(0,a.jsx)(F.Dialog,{open:l,onOpenChange:c,children:(0,a.jsxs)(F.DialogContent,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsxs)(F.DialogTitle,{className:"text-2xl flex items-center gap-2",children:[(0,a.jsx)(P,{className:"w-6 h-6 text-primary"}),"Confirmar Cambio de Plan"]}),(0,a.jsxs)("div",{className:"text-muted-foreground text-base pt-4 space-y-4",children:[(0,a.jsxs)("p",{children:["Est√°s a punto de cambiar al plan"," ",(0,a.jsx)("span",{className:"font-semibold text-primary",children:k.find(e=>e.id===t)?.name}),"."]}),(0,a.jsx)("div",{className:"bg-muted rounded-lg p-4 space-y-2",children:t&&(()=>{let e=k.find(e=>e.id===t);if(!e)return null;let s=e.price,r=R(s),i=r<s;return(0,a.jsxs)(a.Fragment,{children:[i&&(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Precio original:"}),(0,a.jsxs)("span",{className:"line-through text-muted-foreground",children:["$",s,"/mes"]})]}),g.length>0&&(0,a.jsxs)("div",{className:"flex justify-between text-sm text-orange-600",children:[(0,a.jsx)("span",{children:"Promoci√≥n activa:"}),(0,a.jsxs)("span",{className:"font-semibold",children:["-",g[0].discount_percentage?`${g[0].discount_percentage}%`:`$${g[0].discount_amount}`]})]}),x&&(0,a.jsxs)("div",{className:"flex justify-between text-sm text-green-600",children:[(0,a.jsxs)("span",{children:["Cup√≥n (",x.code,"):"]}),(0,a.jsxs)("span",{className:"font-semibold",children:["-",x.discount_percentage?`${x.discount_percentage}%`:`$${x.discount_amount}`]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm border-t pt-2",children:[(0,a.jsx)("span",{className:"font-semibold text-foreground",children:"Precio final:"}),(0,a.jsxs)("span",{className:`font-bold text-lg ${i?"text-green-600":"text-foreground"}`,children:["$",r.toFixed(2),"/mes"]})]}),i&&(0,a.jsxs)("div",{className:"text-center text-xs text-green-600 font-semibold bg-green-50 py-1 rounded",children:["¬°Ahorras $",(s-r).toFixed(2)," al mes!"]})]})})()}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"El cambio se aplicar√° inmediatamente. Se te cobrar√° la nueva tarifa de forma proporcional."})]})]}),(0,a.jsxs)(F.DialogFooter,{className:"gap-3 sm:gap-3 flex-col sm:flex-row",children:[(0,a.jsxs)(S.Button,{type:"button",variant:"outline",onClick:()=>{c(!1),r(null)},disabled:i,className:"w-full sm:flex-1",children:[(0,a.jsx)(w.X,{className:"w-4 h-4 mr-2"}),"Cancelar"]}),(0,a.jsx)(S.Button,{type:"button",onClick:z,disabled:i,className:"w-full sm:flex-1 bg-gradient-to-r from-primary to-accent text-white hover:from-primary/90 hover:to-accent/90",children:i?"Procesando...":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.default,{className:"w-4 h-4 mr-2"}),"Confirmar Cambio"]})})]})]})}),(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-card",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-foreground mb-4",children:"¬øNecesitas ayuda para elegir?"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Todos nuestros planes incluyen acceso a m√°s de 1000 canales internacionales, VOD ilimitado y compatibilidad con todos los dispositivos populares."}),(0,a.jsx)(S.Button,{variant:"outline",children:"Contactar Soporte"})]})]})}let B=(0,t.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var q=e.i(47675);let R=(0,t.default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var z=e.i(19320),O=e.i(69041),H=e.i(40657);function U(){let{user:e}=v(),[a,t]=(0,s.useState)(null),[r,i]=(0,s.useState)(!0),[n,l]=(0,s.useState)(null),c=async()=>{if(!e)return void i(!1);try{i(!0);let a=(0,N.createClient)(),{data:s,error:r}=await a.from("profiles").select("*").eq("id",e.id).single();if(r)throw r;t(s),l(null)}catch(e){console.error("Error fetching profile:",e),l(e instanceof Error?e.message:"Error desconocido")}finally{i(!1)}},o=async a=>{if(!e)return{error:"No hay usuario autenticado"};try{let s=(0,N.createClient)(),{error:t}=await s.from("profiles").update(a).eq("id",e.id);if(t)throw t;return await c(),{error:null}}catch(e){return console.error("Error updating profile:",e),{error:e instanceof Error?e.message:"Error actualizando perfil"}}};return(0,s.useEffect)(()=>{c()},[e]),{profile:a,loading:r,error:n,updateProfile:o,refetch:c}}var V=e.i(67170);let G=[{code:"+51",country:"Per√∫",flag:"üáµüá™",maxDigits:9},{code:"+1",country:"Estados Unidos/Canad√°",flag:"üá∫üá∏",maxDigits:10},{code:"+52",country:"M√©xico",flag:"üá≤üáΩ",maxDigits:10},{code:"+34",country:"Espa√±a",flag:"üá™üá∏",maxDigits:9},{code:"+54",country:"Argentina",flag:"üá¶üá∑",maxDigits:10},{code:"+57",country:"Colombia",flag:"üá®üá¥",maxDigits:10},{code:"+55",country:"Brasil",flag:"üáßüá∑",maxDigits:11},{code:"+56",country:"Chile",flag:"üá®üá±",maxDigits:9},{code:"+49",country:"Alemania",flag:"üá©üá™",maxDigits:11},{code:"+213",country:"Argelia",flag:"üá©üáø",maxDigits:9},{code:"+966",country:"Arabia Saudita",flag:"üá∏üá¶",maxDigits:9},{code:"+61",country:"Australia",flag:"üá¶üá∫",maxDigits:9},{code:"+43",country:"Austria",flag:"üá¶üáπ",maxDigits:10},{code:"+32",country:"B√©lgica",flag:"üáßüá™",maxDigits:9},{code:"+591",country:"Bolivia",flag:"üáßüá¥",maxDigits:8},{code:"+86",country:"China",flag:"üá®üá≥",maxDigits:11},{code:"+82",country:"Corea del Sur",flag:"üá∞üá∑",maxDigits:10},{code:"+506",country:"Costa Rica",flag:"üá®üá∑",maxDigits:8},{code:"+53",country:"Cuba",flag:"üá®üá∫",maxDigits:8},{code:"+45",country:"Dinamarca",flag:"üá©üá∞",maxDigits:8},{code:"+593",country:"Ecuador",flag:"üá™üá®",maxDigits:9},{code:"+20",country:"Egipto",flag:"üá™üá¨",maxDigits:10},{code:"+503",country:"El Salvador",flag:"üá∏üáª",maxDigits:8},{code:"+971",country:"Emiratos √Årabes",flag:"üá¶üá™",maxDigits:9},{code:"+63",country:"Filipinas",flag:"üáµüá≠",maxDigits:10},{code:"+358",country:"Finlandia",flag:"üá´üáÆ",maxDigits:10},{code:"+33",country:"Francia",flag:"üá´üá∑",maxDigits:9},{code:"+502",country:"Guatemala",flag:"üá¨üáπ",maxDigits:8},{code:"+594",country:"Guayana Francesa",flag:"üá¨üá´",maxDigits:9},{code:"+592",country:"Guyana",flag:"üá¨üáæ",maxDigits:7},{code:"+509",country:"Hait√≠",flag:"üá≠üáπ",maxDigits:8},{code:"+504",country:"Honduras",flag:"üá≠üá≥",maxDigits:8},{code:"+91",country:"India",flag:"üáÆüá≥",maxDigits:10},{code:"+62",country:"Indonesia",flag:"üáÆüá©",maxDigits:11},{code:"+972",country:"Israel",flag:"üáÆüá±",maxDigits:9},{code:"+39",country:"Italia",flag:"üáÆüáπ",maxDigits:10},{code:"+81",country:"Jap√≥n",flag:"üáØüáµ",maxDigits:10},{code:"+254",country:"Kenia",flag:"üá∞üá™",maxDigits:10},{code:"+60",country:"Malasia",flag:"üá≤üáæ",maxDigits:10},{code:"+212",country:"Marruecos",flag:"üá≤üá¶",maxDigits:9},{code:"+505",country:"Nicaragua",flag:"üá≥üáÆ",maxDigits:8},{code:"+234",country:"Nigeria",flag:"üá≥üá¨",maxDigits:10},{code:"+47",country:"Noruega",flag:"üá≥üá¥",maxDigits:8},{code:"+64",country:"Nueva Zelanda",flag:"üá≥üáø",maxDigits:9},{code:"+31",country:"Pa√≠ses Bajos",flag:"üá≥üá±",maxDigits:9},{code:"+507",country:"Panam√°",flag:"üáµüá¶",maxDigits:8},{code:"+595",country:"Paraguay",flag:"üáµüáæ",maxDigits:9},{code:"+351",country:"Portugal",flag:"üáµüáπ",maxDigits:9},{code:"+1-787",country:"Puerto Rico",flag:"üáµüá∑",maxDigits:10},{code:"+44",country:"Reino Unido",flag:"üá¨üáß",maxDigits:10},{code:"+1-809",country:"Rep√∫blica Dominicana",flag:"üá©üá¥",maxDigits:10},{code:"+7",country:"Rusia",flag:"üá∑üá∫",maxDigits:10},{code:"+65",country:"Singapur",flag:"üá∏üá¨",maxDigits:8},{code:"+27",country:"Sud√°frica",flag:"üáøüá¶",maxDigits:9},{code:"+46",country:"Suecia",flag:"üá∏üá™",maxDigits:9},{code:"+41",country:"Suiza",flag:"üá®üá≠",maxDigits:9},{code:"+66",country:"Tailandia",flag:"üáπüá≠",maxDigits:9},{code:"+216",country:"T√∫nez",flag:"üáπüá≥",maxDigits:8},{code:"+90",country:"Turqu√≠a",flag:"üáπüá∑",maxDigits:10},{code:"+598",country:"Uruguay",flag:"üá∫üáæ",maxDigits:8},{code:"+58",country:"Venezuela",flag:"üáªüá™",maxDigits:10},{code:"+84",country:"Vietnam",flag:"üáªüá≥",maxDigits:10}];function W(){let e,[t,r]=(0,s.useState)(!1),[i,l]=(0,s.useState)(!1),{invoices:c,loading:o}=function(){let[e,a]=(0,s.useState)([]),[t,r]=(0,s.useState)(!0),[i,n]=(0,s.useState)(null),{user:l}=v();return(0,s.useEffect)(()=>{if(!l){a([]),r(!1);return}(async()=>{try{let e=(0,N.createClient)(),{data:s,error:t}=await e.from("invoices").select("*").eq("user_id",l.id).order("invoice_date",{ascending:!1});if(t)throw t;a(s||[])}catch(e){n(e instanceof Error?e.message:"Error fetching invoices")}finally{r(!1)}})()},[l]),{invoices:e,loading:t,error:i}}(),{profile:m,loading:u,updateProfile:h}=U(),{subscription:g,loading:p}=y(),{toast:f}=(0,L.useToast)(),[j,b]=(0,s.useState)({firstName:"",lastName:"",email:"",countryCode:"+51",phoneNumber:""}),[w,C]=(0,s.useState)("");(0,s.useEffect)(()=>{if(i){let e=(()=>{if(!m)return null;let e="+51",a="";if(m.whatsapp){let s=m.whatsapp.trim(),t=G.find(e=>s.startsWith(e.code));t?(e=t.code,a=s.substring(t.code.length).replace(/\D/g,"")):a=s.replace(/\D/g,"")}return{firstName:m.first_name||"",lastName:m.last_name||"",email:m.email||"",countryCode:e,phoneNumber:a}})();e&&b(e)}},[i]);let k=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),D=()=>{let e=G.find(e=>e.code===j.countryCode);return e?.maxDigits||15},T=()=>{let e=G.find(e=>e.code===j.countryCode);return e&&j.phoneNumber&&j.phoneNumber.length!==e.maxDigits?`Para ${e.country} se requieren exactamente ${e.maxDigits} d\xedgitos`:""},P=async()=>{var e;if(!j.email||(e=j.email,!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))){C("Por favor ingresa un correo electr√≥nico v√°lido"),f({variant:"destructive",title:"Error de validaci√≥n",description:"El correo electr√≥nico no tiene un formato v√°lido",duration:3e3});return}C("");let a=T();if(j.phoneNumber&&a)return void f({variant:"destructive",title:"Error de validaci√≥n",description:a,duration:3e3});let s=j.phoneNumber?`${j.countryCode}${j.phoneNumber.replace(/\s/g,"")}`:"",{error:t}=await h({first_name:j.firstName,last_name:j.lastName,email:j.email,whatsapp:s});t?f({variant:"destructive",title:"Error",description:"No se pudo actualizar la informaci√≥n: "+t,duration:3e3}):(f({variant:"success",title:"‚úì Informaci√≥n actualizada",description:"Tu informaci√≥n de contacto se ha guardado correctamente",duration:3e3}),l(!1))};return o&&0===c.length?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center space-y-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Cargando informaci√≥n de facturaci√≥n..."})]})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-foreground mb-2",children:"Facturaci√≥n"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Gestiona tu cuenta de facturaci√≥n y pagos"})]}),g&&(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-gradient-to-br from-primary/5 to-primary/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(O.Calendar,{className:"w-5 h-5 text-primary"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Pr√≥ximo Pago"})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-background/80 rounded-lg border border-border",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:(0,a.jsx)(H.DollarSign,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Monto a Pagar"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-foreground",children:["$",g.price.toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-background/80 rounded-lg border border-border",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:(0,a.jsx)(O.Calendar,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fecha de Renovaci√≥n"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-foreground",children:k(g.next_billing_date)})]})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-950/30 rounded-lg border border-blue-200 dark:border-blue-800",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-400 flex items-start gap-2",children:[(0,a.jsx)(q.CheckCircle2,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:"Tu suscripci√≥n se renovar√° autom√°ticamente. El cargo se realizar√° el d√≠a de la renovaci√≥n."})]})})]}),(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(x.CreditCard,{className:"w-5 h-5 text-primary"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"M√©todo de Pago"})]}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-4 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm flex-shrink-0",children:(0,a.jsxs)("svg",{viewBox:"0 0 24 24",className:"w-8 h-8",fill:"none",children:[(0,a.jsx)("path",{d:"M12 2L2 7L12 12L22 7L12 2Z",fill:"#009EE3"}),(0,a.jsx)("path",{d:"M2 17L12 22L22 17M2 12L12 17L22 12",stroke:"#009EE3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-foreground",children:"MercadoPago"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Gesti√≥n de pagos conectada"})]})]}),(0,a.jsx)(S.Button,{variant:"outline",size:"sm",className:"w-full sm:w-auto border-primary text-primary hover:bg-primary hover:text-primary-foreground",onClick:()=>r(!0),children:"Configurar"})]})})]}),(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(n.FileText,{className:"w-5 h-5 text-primary"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Historial de Facturas"})]}),0===c.length?(0,a.jsxs)("div",{className:"text-center py-12 space-y-3",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto",children:(0,a.jsx)(n.FileText,{className:"w-8 h-8 text-muted-foreground"})}),(0,a.jsx)("p",{className:"text-muted-foreground font-medium",children:"No hay facturas disponibles"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tus facturas aparecer√°n aqu√≠ cuando realices pagos"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-border",children:[(0,a.jsx)("th",{className:"text-left py-3 text-muted-foreground font-medium",children:"Factura"}),(0,a.jsx)("th",{className:"text-left py-3 text-muted-foreground font-medium",children:"Fecha"}),(0,a.jsx)("th",{className:"text-left py-3 text-muted-foreground font-medium",children:"Monto"}),(0,a.jsx)("th",{className:"text-left py-3 text-muted-foreground font-medium",children:"Estado"}),(0,a.jsx)("th",{className:"text-left py-3 text-muted-foreground font-medium"})]})}),(0,a.jsx)("tbody",{children:c.map(e=>{var s;let t,r=(s=e.status,(t={paid:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-800 dark:text-green-400",label:"Pagado",icon:q.CheckCircle2},pending:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-800 dark:text-yellow-400",label:"Pendiente",icon:R},failed:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-800 dark:text-red-400",label:"Fallido",icon:z.XCircle}})[s]||t.pending),i=r.icon;return(0,a.jsxs)("tr",{className:"border-b border-border hover:bg-muted/50 transition-colors",children:[(0,a.jsx)("td",{className:"py-4 font-medium text-foreground",children:e.id}),(0,a.jsx)("td",{className:"py-4 text-muted-foreground",children:k(e.invoice_date)}),(0,a.jsxs)("td",{className:"py-4 font-medium text-foreground",children:["$",e.amount.toFixed(2)]}),(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium ${r.bg} ${r.text}`,children:[(0,a.jsx)(i,{className:"w-3.5 h-3.5"}),r.label]})}),(0,a.jsx)("td",{className:"py-4",children:(0,a.jsx)("button",{className:"text-primary hover:text-primary/80 transition-colors",children:(0,a.jsx)(B,{className:"w-4 h-4"})})})]},e.id)})})]})})]}),(0,a.jsx)(F.Dialog,{open:t,onOpenChange:r,children:(0,a.jsxs)(F.DialogContent,{children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsx)(F.DialogTitle,{children:"Configurar M√©todo de Pago"}),(0,a.jsx)(F.DialogDescription,{children:"Conecta tu cuenta de MercadoPago para gestionar tus pagos de forma segura"})]}),(0,a.jsxs)("div",{className:"space-y-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm",children:(0,a.jsxs)("svg",{viewBox:"0 0 24 24",className:"w-12 h-12",fill:"none",children:[(0,a.jsx)("path",{d:"M12 2L2 7L12 12L22 7L12 2Z",fill:"#009EE3"}),(0,a.jsx)("path",{d:"M2 17L12 22L22 17M2 12L12 17L22 12",stroke:"#009EE3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"MercadoPago"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Procesamiento seguro de pagos con MercadoPago"})]})]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm text-muted-foreground",children:[(0,a.jsxs)("p",{className:"flex items-start gap-2",children:[(0,a.jsx)(q.CheckCircle2,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:"Pagos seguros y encriptados"})]}),(0,a.jsxs)("p",{className:"flex items-start gap-2",children:[(0,a.jsx)(q.CheckCircle2,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:"M√∫ltiples m√©todos de pago disponibles"})]}),(0,a.jsxs)("p",{className:"flex items-start gap-2",children:[(0,a.jsx)(q.CheckCircle2,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:"Gesti√≥n autom√°tica de suscripciones"})]})]})]}),(0,a.jsxs)(F.DialogFooter,{children:[(0,a.jsx)(S.Button,{variant:"outline",onClick:()=>r(!1),children:"Cancelar"}),(0,a.jsx)(S.Button,{onClick:()=>{f({title:"MercadoPago",description:"Funcionalidad de integraci√≥n pr√≥ximamente disponible"}),r(!1)},className:"bg-[#009EE3] hover:bg-[#0082BD]",children:"Conectar con MercadoPago"})]})]})}),(0,a.jsx)(F.Dialog,{open:i,onOpenChange:l,children:(0,a.jsxs)(F.DialogContent,{className:"max-w-lg",children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsx)(F.DialogTitle,{children:"Editar Informaci√≥n del Cliente"}),(0,a.jsx)(F.DialogDescription,{children:"Actualiza tu informaci√≥n de contacto"})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"firstName",className:"flex items-center gap-2",children:"Nombre"}),(0,a.jsx)(_.Input,{id:"firstName",value:j.firstName,onChange:e=>b({...j,firstName:e.target.value}),placeholder:"Juan"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"lastName",className:"flex items-center gap-2",children:"Apellido"}),(0,a.jsx)(_.Input,{id:"lastName",value:j.lastName,onChange:e=>b({...j,lastName:e.target.value}),placeholder:"P√©rez"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"email",className:"flex items-center gap-2",children:"Correo electr√≥nico"}),(0,a.jsx)(_.Input,{id:"email",type:"email",value:j.email,onChange:e=>{let a=e.target.value;(b({...j,email:a}),a&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))?C("Formato de correo inv√°lido"):C("")},placeholder:"cliente@ejemplo.com",className:w?"border-red-500":""}),w&&(0,a.jsx)("p",{className:"text-xs text-red-500 mt-1",children:w})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"whatsapp",className:"flex items-center gap-2",children:"WhatsApp"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(V.Select,{value:j.countryCode,onValueChange:e=>{b({...j,countryCode:e,phoneNumber:""})},children:[(0,a.jsx)(V.SelectTrigger,{className:"w-[140px]",children:(0,a.jsx)(V.SelectValue,{children:(e=G.find(e=>e.code===j.countryCode))?(0,a.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"text-base",children:e.flag}),(0,a.jsx)("span",{className:"text-sm",children:e.code})]}):"Seleccionar"})}),(0,a.jsx)(V.SelectContent,{className:"max-h-[300px]",children:G.map(e=>(0,a.jsx)(V.SelectItem,{value:e.code,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-base",children:e.flag}),(0,a.jsx)("span",{className:"text-sm",children:e.code}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.country,")"]})]})},e.code))})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(_.Input,{id:"whatsapp",type:"tel",value:j.phoneNumber,onChange:e=>{let a=e.target.value.replace(/[^\d]/g,""),s=D();a.length<=s&&b({...j,phoneNumber:a})},placeholder:`${"9".repeat(D())}`,maxLength:D(),className:T()?"border-red-500":""}),T()&&(0,a.jsx)("p",{className:"text-xs text-red-500 mt-1",children:T()})]})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Formato: ",j.countryCode,j.phoneNumber||`${"9".repeat(D())}`]})]})]}),(0,a.jsxs)(F.DialogFooter,{children:[(0,a.jsx)(S.Button,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),(0,a.jsx)(S.Button,{onClick:P,children:"Guardar cambios"})]})]})})]})}var Z=e.i(77900);let K=(0,t.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),J=(0,t.default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var X=e.i(27447);function Y(){let[e,t]=(0,s.useState)(!1),[r,i]=(0,s.useState)(null),{credentials:n,loading:l}=function(){let[e,a]=(0,s.useState)(null),[t,r]=(0,s.useState)(!0),[i,n]=(0,s.useState)(null),{user:l}=v();return(0,s.useEffect)(()=>{if(!l){a(null),r(!1);return}(async()=>{try{let e=(0,N.createClient)(),{data:s,error:t}=await e.from("credentials").select("*").eq("user_id",l.id).single();if(t&&"PGRST116"!==t.code)throw t;a(s||null)}catch(e){n(e instanceof Error?e.message:"Error fetching credentials")}finally{r(!1)}})()},[l]),{credentials:e,loading:t,error:i}}(),c=(e,a)=>{navigator.clipboard.writeText(e),i(a),setTimeout(()=>i(null),2e3)};return l?(0,a.jsx)("div",{className:"text-center py-8",children:"Cargando credenciales..."}):n?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-foreground mb-2",children:"Credenciales de Acceso"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Usa estas credenciales para acceder a MaxPlayer IPTV"})]}),(0,a.jsx)(d.Card,{className:"p-4 border-orange-300 bg-orange-50 dark:bg-orange-900/20",children:(0,a.jsx)("p",{className:"text-sm text-orange-900 dark:text-orange-300",children:"Mant√©n tus credenciales confidenciales. No las compartas con terceros."})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Usuario"}),(0,a.jsx)("button",{onClick:()=>c(n.username,"username"),className:"text-accent hover:text-accent/80 transition-colors",children:(0,a.jsx)(Z.Copy,{className:"w-4 h-4"})})]}),(0,a.jsx)("p",{className:"font-mono text-lg font-semibold text-foreground break-all",children:n.username}),"username"===r&&(0,a.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"Copiado"})]}),(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Contrase√±a"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>t(!e),className:"text-muted-foreground hover:text-foreground transition-colors",children:e?(0,a.jsx)(J,{className:"w-4 h-4"}):(0,a.jsx)(K,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>c(n.password,"password"),className:"text-accent hover:text-accent/80 transition-colors",children:(0,a.jsx)(Z.Copy,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("p",{className:"font-mono text-lg font-semibold text-foreground break-all",children:e?n.password:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"}),"password"===r&&(0,a.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"Copiado"})]}),(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Direcci√≥n MAC"}),(0,a.jsx)("button",{onClick:()=>c(n.mac_address,"mac"),className:"text-accent hover:text-accent/80 transition-colors",children:(0,a.jsx)(Z.Copy,{className:"w-4 h-4"})})]}),(0,a.jsx)("p",{className:"font-mono text-lg font-semibold text-foreground break-all",children:n.mac_address}),"mac"===r&&(0,a.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"Copiado"})]}),(0,a.jsxs)(d.Card,{className:"p-6 border border-border bg-card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"C√≥digo Revendedor"}),(0,a.jsx)("button",{onClick:()=>c(n.reseller_code,"reseller"),className:"text-accent hover:text-accent/80 transition-colors",children:(0,a.jsx)(Z.Copy,{className:"w-4 h-4"})})]}),(0,a.jsx)("p",{className:"font-mono text-lg font-semibold text-foreground break-all",children:n.reseller_code}),"reseller"===r&&(0,a.jsx)("p",{className:"text-xs text-green-600 mt-2",children:"Copiado"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Opciones de Seguridad"}),(0,a.jsxs)(S.Button,{variant:"outline",className:"w-full flex items-center gap-2 bg-transparent",children:[(0,a.jsx)(X.RefreshCw,{className:"w-4 h-4"}),"Cambiar contrase√±a"]}),(0,a.jsx)(S.Button,{variant:"outline",className:"w-full bg-transparent",children:"Historial de conexiones"})]})]}):(0,a.jsx)("div",{className:"text-center py-8",children:"No hay credenciales disponibles"})}let Q={email_notifications:!0,whatsapp_notifications:!0,renewal_reminder:!0,plan_changes_notifications:!0};var ee=e.i(94306),ea=e.i(86048),es=e.i(89408);function et({profile:e,updateProfile:t}){let{toast:r}=(0,L.useToast)(),[i,n]=(0,s.useState)(!1),[l,c]=(0,s.useState)({firstName:"",lastName:"",email:"",countryCode:"+51",phoneNumber:""}),[o,m]=(0,s.useState)("");(0,s.useEffect)(()=>{if(i){let a=(()=>{if(!e)return null;let a="+51",s="";if(e.whatsapp){let t=e.whatsapp.trim(),r=G.find(e=>t.startsWith(e.code));r?(a=r.code,s=t.substring(r.code.length).replace(/\D/g,"")):s=t.replace(/\D/g,"")}return{firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",countryCode:a,phoneNumber:s}})();a&&c(a)}},[i,e]);let u=async()=>{var e;let a;if(!l.email||(e=l.email,!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))){m("Por favor ingresa un correo electr√≥nico v√°lido"),r({variant:"destructive",title:"Error de validaci√≥n",description:"El correo electr√≥nico no tiene un formato v√°lido",duration:3e3});return}m("");let s=(a=G.find(e=>e.code===l.countryCode))&&l.phoneNumber&&l.phoneNumber.length!==a.maxDigits?`Para ${a.country} se requieren exactamente ${a.maxDigits} d\xedgitos`:"";if(l.phoneNumber&&s)return void r({variant:"destructive",title:"Error de validaci√≥n",description:s,duration:3e3});let i=l.phoneNumber?`${l.countryCode}${l.phoneNumber.replace(/\s/g,"")}`:"",{error:c}=await t({first_name:l.firstName,last_name:l.lastName,email:l.email,whatsapp:i});c?r({variant:"destructive",title:"Error",description:"No se pudo actualizar la informaci√≥n: "+c,duration:3e3}):(r({variant:"success",title:"‚úì Informaci√≥n actualizada",description:"Tu informaci√≥n de contacto se ha guardado correctamente",duration:3e3}),n(!1))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ee.User,{className:"w-5 h-5 text-primary"}),(0,a.jsx)(d.CardTitle,{children:"Cuenta y Seguridad"})]}),(0,a.jsx)(S.Button,{variant:"outline",size:"sm",className:"border-primary text-primary hover:bg-primary hover:text-primary-foreground",onClick:()=>n(!0),children:"Editar informaci√≥n"})]}),(0,a.jsx)(d.CardDescription,{children:"Tu informaci√≥n personal y opciones de seguridad"})]}),(0,a.jsx)(d.CardContent,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,a.jsx)(ee.User,{className:"w-4 h-4 text-primary"}),"Informaci√≥n Personal"]}),(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-primary/5 to-transparent rounded-lg border border-primary/10",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(ee.User,{className:"w-5 h-5 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Nombre completo"}),(0,a.jsx)("p",{className:"text-base font-medium text-foreground",children:e?.first_name||e?.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():"No especificado"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-primary/5 to-transparent rounded-lg border border-primary/10",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(ea.Mail,{className:"w-5 h-5 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Correo electr√≥nico"}),(0,a.jsx)("p",{className:"text-base font-medium text-foreground truncate",children:e?.email||"No especificado"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-primary/5 to-transparent rounded-lg border border-primary/10",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(es.Phone,{className:"w-5 h-5 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"WhatsApp"}),(0,a.jsx)("p",{className:"text-base font-medium text-foreground",children:e?.whatsapp||"No especificado"})]})]})]})]})})]}),(0,a.jsx)(F.Dialog,{open:i,onOpenChange:n,children:(0,a.jsxs)(F.DialogContent,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsx)(F.DialogTitle,{children:"Editar Informaci√≥n Personal"}),(0,a.jsx)(F.DialogDescription,{children:"Actualiza tus datos de contacto aqu√≠."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"firstName",children:"Nombre"}),(0,a.jsx)(_.Input,{id:"firstName",value:l.firstName,onChange:e=>c({...l,firstName:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"lastName",children:"Apellido"}),(0,a.jsx)(_.Input,{id:"lastName",value:l.lastName,onChange:e=>c({...l,lastName:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"email",children:"Correo Electr√≥nico"}),(0,a.jsx)(_.Input,{id:"email",type:"email",value:l.email,onChange:e=>{c({...l,email:e.target.value}),m("")},className:o?"border-red-500":""}),o&&(0,a.jsx)("p",{className:"text-xs text-red-500",children:o})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"whatsapp",children:"WhatsApp"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(V.Select,{value:l.countryCode,onValueChange:e=>c({...l,countryCode:e}),children:[(0,a.jsx)(V.SelectTrigger,{className:"w-[140px]",children:(0,a.jsx)(V.SelectValue,{placeholder:"Pa√≠s"})}),(0,a.jsx)(V.SelectContent,{className:"max-h-[300px]",children:G.map(e=>(0,a.jsxs)(V.SelectItem,{value:e.code,children:[(0,a.jsx)("span",{className:"mr-2",children:e.flag}),e.code]},e.code))})]}),(0,a.jsx)(_.Input,{id:"whatsapp",type:"tel",placeholder:"N√∫mero",value:l.phoneNumber,onChange:e=>{let a,s=e.target.value.replace(/\D/g,""),t=(a=G.find(e=>e.code===l.countryCode),a?.maxDigits||15);s.length<=t&&c({...l,phoneNumber:s})},className:"flex-1"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:l.countryCode&&G.find(e=>e.code===l.countryCode)?.country})]})]}),(0,a.jsxs)(F.DialogFooter,{children:[(0,a.jsx)(S.Button,{variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),(0,a.jsx)(S.Button,{onClick:u,children:"Guardar Cambios"})]})]})})]})}var er=e.i(16279),ei=e.i(98194);function en({settings:e,updateSettings:t}){let{toast:r}=(0,L.useToast)(),[i,n]=(0,s.useState)({email:!0,whatsapp:!0,renewalReminder:!0,planChanges:!0}),[l,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{e&&n({email:e.email_notifications??!0,whatsapp:e.whatsapp_notifications??!0,renewalReminder:e.renewal_reminder??!0,planChanges:e.plan_changes_notifications??!0})},[e]);let o=async()=>{c(!0);try{(await t({email_notifications:i.email,whatsapp_notifications:i.whatsapp,renewal_reminder:i.renewalReminder,plan_changes_notifications:i.planChanges})).success?r({variant:"success",title:"Configuraci√≥n guardada",description:"Tus preferencias han sido actualizadas correctamente.",duration:3e3}):r({title:"Error al guardar",description:"No se pudo guardar la configuraci√≥n.",variant:"destructive",duration:3e3})}catch(e){r({title:"Error al guardar",description:"Ocurri√≥ un error al guardar.",variant:"destructive",duration:3e3})}finally{c(!1)}};return(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ei.Bell,{className:"w-5 h-5 text-primary"}),(0,a.jsx)(d.CardTitle,{children:"Notificaciones"})]}),(0,a.jsx)(d.CardDescription,{children:"Configura c√≥mo y cu√°ndo quieres recibir notificaciones"})]}),(0,a.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(E.Label,{htmlFor:"email-notifications",children:"Notificaciones por Email"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recibe actualizaciones por correo electr√≥nico"})]}),(0,a.jsx)(er.Switch,{id:"email-notifications",checked:i.email,onCheckedChange:e=>n({...i,email:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(E.Label,{htmlFor:"whatsapp-notifications",children:"Notificaciones por WhatsApp"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recibe alertas por WhatsApp"})]}),(0,a.jsx)(er.Switch,{id:"whatsapp-notifications",checked:i.whatsapp,onCheckedChange:e=>n({...i,whatsapp:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(E.Label,{htmlFor:"renewal-reminder",children:"Recordatorio de Renovaci√≥n"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Te avisamos antes de que venza tu suscripci√≥n"})]}),(0,a.jsx)(er.Switch,{id:"renewal-reminder",checked:i.renewalReminder,onCheckedChange:e=>n({...i,renewalReminder:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(E.Label,{htmlFor:"plan-changes",children:"Cambios de Plan"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Notificaciones sobre actualizaciones de tu plan"})]}),(0,a.jsx)(er.Switch,{id:"plan-changes",checked:i.planChanges,onCheckedChange:e=>n({...i,planChanges:e})})]}),(0,a.jsx)(S.Button,{onClick:o,className:"w-full mt-4",disabled:l,children:l?"Guardando...":"Guardar Preferencias"})]})]})}var el=e.i(11292),ec=e.i(46158),eo=e.i(30759),ed=e.i(31116),em=(0,ed.createServerReference)("40df9a50f8f7f384b9cf18a7f7a884249bbe6d64f0",ed.callServer,void 0,ed.findSourceMapURL,"deleteUserAccount");function eu({user:e}){let{toast:t}=(0,L.useToast)(),r=(0,N.createClient)(),[i,n]=(0,s.useState)(!1),[l,c]=(0,s.useState)(!1),[o,m]=(0,s.useState)(""),[u,x]=(0,s.useState)({current:"",new:"",confirm:""}),[h,g]=(0,s.useState)({new:"",confirm:"",general:""}),[p,f]=(0,s.useState)(!1),j=async()=>{if(g({new:"",confirm:"",general:""}),!u.new||!u.confirm){g({new:u.new?"":"Este campo es requerido",confirm:u.confirm?"":"Este campo es requerido",general:""}),t({title:"Error",description:"Por favor completa todos los campos.",variant:"destructive",duration:3e3});return}if(u.new.length<8){g({new:"La contrase√±a debe tener al menos 8 caracteres",confirm:"",general:""}),t({title:"Error",description:"La contrase√±a debe tener al menos 8 caracteres.",variant:"destructive",duration:3e3});return}if(u.new!==u.confirm){g({new:"",confirm:"Las contrase√±as no coinciden",general:""}),t({title:"Error",description:"Las contrase√±as nuevas no coinciden.",variant:"destructive",duration:3e3});return}f(!0);try{let{error:e}=await r.auth.updateUser({password:u.new});e?t({title:"Error al cambiar contrase√±a",description:e.message,variant:"destructive",duration:3e3}):(t({variant:"success",title:"Contrase√±a actualizada",description:"Tu contrase√±a ha sido cambiada exitosamente.",duration:3e3}),c(!1),x({current:"",new:"",confirm:""}),g({new:"",confirm:"",general:""}))}catch(e){t({title:"Error al cambiar contrase√±a",description:"Ocurri√≥ un error al cambiar la contrase√±a.",variant:"destructive",duration:3e3})}finally{f(!1)}},b=async()=>{if("ELIMINAR"!==o)return void t({title:"Error",description:"Por favor escribe ELIMINAR para confirmar.",variant:"destructive",duration:3e3});if(!e?.id)return void t({title:"Error",description:"No se pudo identificar el usuario.",variant:"destructive",duration:3e3});try{let a=await em(e.id);if(!a.success)return void t({title:"Error",description:a.error||"No se pudo eliminar la cuenta. Contacta con soporte.",variant:"destructive",duration:3e3});await r.auth.signOut(),window.location.href="/auth/login"}catch(e){console.error("Error deleting account:",e),t({title:"Error",description:"Ocurri√≥ un error inesperado. Contacta con soporte.",variant:"destructive",duration:3e3})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(el.Shield,{className:"w-5 h-5 text-primary"}),(0,a.jsx)(d.CardTitle,{children:"Seguridad"})]})}),(0,a.jsx)(d.CardDescription,{children:"Opciones de seguridad de tu cuenta"})]}),(0,a.jsx)(d.CardContent,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,a.jsx)(el.Shield,{className:"w-4 h-4 text-primary"}),"Contrase√±a"]}),(0,a.jsxs)("button",{onClick:()=>c(!0),className:"w-full flex items-center justify-between p-4 bg-gradient-to-r from-primary/5 to-transparent rounded-lg border border-primary/10 hover:border-primary/30 transition-all group",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0 group-hover:bg-primary/20 transition-colors",children:(0,a.jsx)(ec.Lock,{className:"w-5 h-5 text-primary"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Cambiar Contrase√±a"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Actualiza tu contrase√±a de acceso"})]})]}),(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-muted-foreground group-hover:text-primary transition-colors",children:(0,a.jsx)("path",{d:"m9 18 6-6-6-6"})})]})]})})]}),(0,a.jsxs)(d.Card,{className:"border-destructive/50 mt-6",children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eo.Trash2,{className:"w-5 h-5 text-destructive"}),(0,a.jsx)(d.CardTitle,{className:"text-destructive",children:"Zona Peligrosa"})]}),(0,a.jsx)(d.CardDescription,{children:"Acciones irreversibles en tu cuenta"})]}),(0,a.jsx)(d.CardContent,{className:"space-y-4",children:(0,a.jsxs)(S.Button,{onClick:()=>n(!0),variant:"destructive",className:"w-full",children:[(0,a.jsx)(eo.Trash2,{className:"w-4 h-4 mr-2"}),"Eliminar Cuenta"]})})]}),(0,a.jsx)(F.Dialog,{open:l,onOpenChange:c,children:(0,a.jsxs)(F.DialogContent,{children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsx)(F.DialogTitle,{children:"Cambiar Contrase√±a"}),(0,a.jsx)(F.DialogDescription,{children:"Ingresa tu nueva contrase√±a (m√≠nimo 8 caracteres)"})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"new-password",children:"Nueva Contrase√±a"}),(0,a.jsx)(_.Input,{id:"new-password",type:"password",value:u.new,onChange:e=>x({...u,new:e.target.value}),className:h.new?"border-destructive":""}),h.new&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:h.new}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"M√≠nimo 8 caracteres"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(E.Label,{htmlFor:"confirm-password",children:"Confirmar Nueva Contrase√±a"}),(0,a.jsx)(_.Input,{id:"confirm-password",type:"password",value:u.confirm,onChange:e=>x({...u,confirm:e.target.value}),className:h.confirm?"border-destructive":""}),h.confirm&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:h.confirm})]})]}),(0,a.jsxs)(F.DialogFooter,{children:[(0,a.jsx)(S.Button,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),(0,a.jsx)(S.Button,{onClick:j,disabled:p,children:p?"Actualizando...":"Actualizar Contrase√±a"})]})]})}),(0,a.jsx)(F.Dialog,{open:i,onOpenChange:n,children:(0,a.jsxs)(F.DialogContent,{children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsx)(F.DialogTitle,{className:"text-destructive",children:"Eliminar Cuenta"}),(0,a.jsx)(F.DialogDescription,{children:"Esta acci√≥n es irreversible. Todos tus datos ser√°n eliminados permanentemente."})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mb-4",children:["Para confirmar, escribe ",(0,a.jsx)("strong",{children:"ELIMINAR"})," en el campo de abajo:"]}),(0,a.jsx)(_.Input,{placeholder:"ELIMINAR",value:o,onChange:e=>m(e.target.value)})]}),(0,a.jsxs)(F.DialogFooter,{children:[(0,a.jsx)(S.Button,{variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),(0,a.jsx)(S.Button,{variant:"destructive",onClick:b,disabled:"ELIMINAR"!==o,children:"Eliminar Cuenta"})]})]})})]})}function ex({subscription:e}){let{toast:t}=(0,L.useToast)(),[r,i]=(0,s.useState)(!1),[n,l]=(0,s.useState)(!1),c=async()=>{l(!0);try{await new Promise(e=>setTimeout(e,1500)),t({variant:"success",title:"Dispositivos reseteados",description:"Todos los dispositivos han sido desconectados exitosamente.",duration:3e3}),i(!1)}catch(e){t({title:"Error",description:"No se pudieron resetear los dispositivos.",variant:"destructive",duration:3e3})}finally{l(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(d.Card,{id:"devices-section",children:[(0,a.jsxs)(d.CardHeader,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j,{className:"w-5 h-5 text-primary"}),(0,a.jsx)(d.CardTitle,{children:"Gesti√≥n de Dispositivos"})]}),(0,a.jsx)(d.CardDescription,{children:"Administra los dispositivos conectados a tu cuenta"})]}),(0,a.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-primary/5 to-transparent rounded-lg border border-primary/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(j,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-base font-medium text-foreground",children:"Dispositivos conectados"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["2 de ",e?.plan?.max_screens||1," dispositivos activos"]})]})]}),(0,a.jsx)(S.Button,{variant:"outline",size:"sm",className:"border-destructive text-destructive hover:bg-destructive hover:text-destructive-foreground",onClick:()=>i(!0),children:"Resetear Dispositivos"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Al resetear los dispositivos, se desconectar√°n todos los dispositivos actualmente conectados. Deber√°s volver a iniciar sesi√≥n en cada uno de ellos."})]})]}),(0,a.jsx)(F.Dialog,{open:r,onOpenChange:i,children:(0,a.jsxs)(F.DialogContent,{children:[(0,a.jsxs)(F.DialogHeader,{children:[(0,a.jsx)(F.DialogTitle,{children:"Resetear Dispositivos"}),(0,a.jsx)(F.DialogDescription,{children:"¬øEst√°s seguro de que deseas desconectar todos los dispositivos?"})]}),(0,a.jsxs)(F.DialogFooter,{children:[(0,a.jsx)(S.Button,{variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),(0,a.jsx)(S.Button,{variant:"destructive",onClick:c,disabled:n,children:n?"Reseteando...":"S√≠, Resetear Todo"})]})]})})]})}function eh(){let{settings:e,loading:t,updateSettings:r}=function(){let e=(0,N.createClient)(),{user:a}=v(),[t,r]=(0,s.useState)(Q),[i,n]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null);(0,s.useEffect)(()=>{a&&o()},[a]);let o=async()=>{try{n(!0),console.log("[v0] Cargando settings para usuario:",a?.id);let{data:s,error:t}=await e.from("user_settings").select("*").eq("user_id",a?.id).single();if(t){console.log("[v0] Settings table not found, using defaults:",t.message),r(Q),c(null);return}console.log("[v0] Settings cargados:",s),r(s)}catch(e){console.log("[v0] Error fetching settings, using defaults:",e),r(Q),c(null)}finally{n(!1)}};return{settings:t,loading:i,error:l,updateSettings:async s=>{try{let{data:t}=await e.from("user_settings").select("id").eq("user_id",a?.id).single();if(t){let{error:t}=await e.from("user_settings").update({...s,updated_at:new Date().toISOString()}).eq("user_id",a?.id);if(t)return console.log("[v0] Cannot save to DB, updating locally only:",t),r(e=>({...e,...s})),{success:!0,local:!0}}else{let{error:t}=await e.from("user_settings").insert({user_id:a?.id,...Q,...s});if(t)return console.log("[v0] Cannot create settings in DB, updating locally only:",t),r(e=>({...e,...s})),{success:!0,local:!0}}return r(e=>({...e,...s})),{success:!0}}catch(e){return console.error("[v0] Error updating settings:",e),r(e=>({...e,...s})),{success:!0,local:!0}}},refetch:o}}(),{profile:i,loading:n,updateProfile:l}=U(),{subscription:c}=y(),{user:o}=v();return t||n?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Cargando configuraci√≥n..."})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Configuraci√≥n"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Administra las preferencias de tu cuenta"})]}),(0,a.jsx)(et,{profile:i,updateProfile:l}),(0,a.jsx)(en,{settings:e,updateSettings:r}),(0,a.jsx)(ex,{subscription:c}),(0,a.jsx)(eu,{user:o})]})}var eg=e.i(70021);function ep(){let[e,t]=(0,s.useState)("home"),[r,i]=(0,s.useState)(!1),[n,l]=(0,s.useState)(!0),c=(0,eg.useRouter)();(0,s.useEffect)(()=>{d()},[]);let d=async()=>{let e=(0,N.createBrowserClient)(),{data:{user:a}}=await e.auth.getUser();if(a){let{data:s}=await e.from("profiles").select("role").eq("id",a.id).single();i(s?.role==="admin")}l(!1)};return(0,a.jsxs)(o,{currentView:e,setCurrentView:t,children:[!n&&r&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)(S.Button,{onClick:()=>c.push("/admin"),className:"w-full gap-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[(0,a.jsx)(el.Shield,{className:"h-4 w-4"}),"Acceder al Panel de Administraci√≥n"]})}),(0,a.jsxs)("div",{className:"min-h-[600px]",children:[(0,a.jsx)("div",{style:{display:"home"===e?"block":"none"},children:(0,a.jsx)(D,{setCurrentView:t})}),(0,a.jsx)("div",{style:{display:"plans"===e?"block":"none"},children:(0,a.jsx)(M,{setCurrentView:t})}),(0,a.jsx)("div",{style:{display:"billing"===e?"block":"none"},children:(0,a.jsx)(W,{})}),(0,a.jsx)("div",{style:{display:"credentials"===e?"block":"none"},children:(0,a.jsx)(Y,{})}),(0,a.jsx)("div",{style:{display:"settings"===e?"block":"none"},children:(0,a.jsx)(eh,{})})]})]})}e.s(["default",()=>ep],14800)}]);